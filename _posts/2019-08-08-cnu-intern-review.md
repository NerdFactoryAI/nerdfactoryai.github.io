---
layout: post
title:  "Spring MVC 웹 기반의 크롤러 개발"
author: ["cnu_june", "cnu_salmon", "cnu_dexter"]
date:   2019-08-08 14:00:00 -0600
abstract: "본 게시글은 지난 6월 19일부터 진행된 백마인턴십 과정 중, June, Dexter, Salmon 세 명의 어시스턴트가 함께 진행한 프로젝트에 대한 간략한 설명과 개발 과정에서의 느낀 점, 후기를 담고 있습니다."
tags: ["Crawler", "Spring_MVC", "Ajax", "Bootstrap"]
image: /assets/images/posts/cnu2019intern/0.png
draft: "no"
---

{:.center}
![img0](/assets/images/posts/cnu2019intern/0.jpeg)
*백마인턴십 어시스턴트들*

# Abstract

중소기업, 강소기업, 스타트업. 여러 기업들이 필요로 하는 정보를 한곳에 수집하는 웹 크롤러 개발 프로젝트를 진행하였습니다. 진행된 프로젝트명은 '정책정보 정보 수집기'이며 해당 프로젝트가 Spring 환경에서 구현됨에 따라 사용된 Spring 기술을 명시합니다.

# 중소기업을 대상으로 한 정책정보 수집 시스템

{:.center}
![img1](/assets/images/posts/cnu2019intern/1.png)
*이미지 출처: [중소벤처기업부](https://www.mss.go.kr/){:target=“_blank”}{:.markdown-link-caption}*

현대에는 중소기업을 위한 정책이나 정보가 무척이나 많습니다. 기업마당 지원사업은 매일 새로운 사업이 등록되고, 중소벤처기업부의 보도자료도 매일같이 보도되고, 중소기업을 위한 독자적인 뉴스를 다루는 웹사이트도 정말 많습니다. 하지만 바쁜 중소기업이 이러한 정보를 매일같이, 모두 확인하기란 힘든 일입니다. 어딘가, 한눈에 볼 수 있게 정보를 모아둔다면 아주 의미 있는 일이 될 것입니다. 저희 어시스턴트들이 백마인턴십 과정에서 진행한 프로젝트는, 이러한 모든 정책과 정보를 수집하는 웹 크롤러를 개발하는 것입니다.

# 구현방법

## Spring MVC Web Project 

먼저, 특이한 점을 뽑자면, 웹 크롤러를 웹 프로젝트로 만들었다는 것입니다. 크롤러는 JAVA로 개발되었지만, Spring MVC 패턴을 따른 구조로 웹 프로젝트를 만들고, 웹 프로젝트에 탑재하기 위해 일반적으로 Spring에서 Service라 부르는 형태의 클래스가 되었습니다.

{:.center}
![img2](/assets/images/posts/cnu2019intern/2.png)
*Spring Framework 의 로고*

## @Async

웹의 특성상, 비동기적으로, 병렬로 작업을 처리하기가 수월하지 않습니다. 일반적인 자바 프로그램이라면 쓰레드를 통해서 쉽게 구현할 수 있지만, 스프링에서 그런 형태가 가능한지는 조사가 필요했습니다. 다행히 스프링에서 제공하는 @Async Annotation을 찾아 간단하게 비동기 환경을 구축할 수 있었습니다. 또한 ThreadPoolTaskExecutor를 사용하여 병렬 처리까지 구현할 수 있었습니다.

## @PostConstruct

웹 프로젝트라면 크롬 같은 웹 브라우저로 접근하기 전에는 아무런 작업을 줄 수 없는 게 아닐까 생각할 수 있습니다. @PostConstruct Annotation을 이용하면 URL에 접근할 필요 없이, 서버가 실행되면 서버 내에서 알아서 작업을 실행하는 웹 프로젝트가 구현됩니다.

## ScheduledThread

크롤러가 지속적이며 미리 정해진 일정에 따라 데이터를 지속적으로 수집해야 했습니다. 이를 위해 저희 프로젝트는 자바의 ScheduledThread를 사용하여 일정 주기마다 함수를 실행해서 쓰레드의 상태를 확인하고, 작업이 완료된 크롤러만 찾아 재가동시키는 등의 작업이 가능합니다.

## Future

해당 크롤러를 정지하거나 다시 재개하는 작업이 있다면 다른 크롤러에 구애받지 않고 하나의 크롤러에 대한 수정 작업을 할 수 있을 것입니다. 이를 위해 자바에서는 Future라는 객체가 존재합니다. Future는 stop, isDone, isCancel등의 쓰레드 조작을 위한 함수나 상태를 알 수 있는 내장함수를 가지고 있습니다. 이를 이용하여 각 크롤러 쓰레드를 조작할 수 있습니다.

## Result

이러한 과정 끝에, 저희 프로젝트는 Tomcat 서버가 실행되면 자동으로 데이터 수집을 시작하고, 데이터 수집 중 언제든지 서버의 URL을 통해 관리자 페이지로 접근하여 실시간으로 데이터 수집 정보를 확인할 수 있는 웹 프로젝트가 되었습니다.

# 관리자 페이지

{:.center}
![img3](/assets/images/posts/cnu2019intern/3.png)
*관리자 페이지 메인화면 스크린샷*

관리자 페이지의 목적은 한 사람의 담당자가 데이터 수집 상태와 실제 들어가 있는 데이터를 실시간으로 확인하는 데 있습니다. 이러한 목적을 달성하기 위한 중요 기능은 다음과 같습니다.

1. 사용자 인증을 통한 접속제한(로그인 기능)
2. 데이터베이스에 저장된 총 데이터 개수 확인
3. 각 사이트별 크롤러 작동 현황 확인
4. 각 사이트별 수집한 데이터 확인
5. 에러 로그를 모아 보기

## AJAX – JACKSON

{:.center}
![img4](/assets/images/posts/cnu2019intern/4.png)
*Ajax 의 로고*

중요 기능을 구현하기 위해서는 데이터베이스의 정보와 JAVA 크롤러의 정보를 실시간으로 가져와 View에 출력하는 것이 핵심이었는데요, 이를 AJAX를 통해 구현할 수 있었습니다.

Spring Mapping URL을 통해 AJAX로 접근하고, 컨트롤러에서 모델을 통해 처리한 데이터를 JSON 방식으로 가져와 View에서 출력하는 방식입니다. 이와 같은 AJAX 연결로 인해 View에서의 자바스크립트 코딩으로 컨트롤러에 접근할 수 있어 개발에 상당히 용이했습니다.

## Bootstrap

{:.center}
![img5](/assets/images/posts/cnu2019intern/5.png)
*Bootstrap 의 로고*

관리자 페이지의 모든 View는 부트스트랩 탬플릿을 사용하여 구현하였습니다. CSS 프레임워크 부트스트랩을 사용하면 좋은 템플릿 디자인을 쉽게 구할 수 있고 반응형 웹페이지를 쉽게 구현할 수 있어, 기능개발에 좀 더 집중할 수 있었습니다. 또한 부트스트랩의 확장인 animate, notify, datatables등도 사용하여 View의 퀄리티를 향상시킬 수 있었습니다.

# 후기

## June

안녕하세요. 너드팩토리의 어시스턴트 June 윤지승입니다. 저는 주로 스프링 내부 설계를 담당하였습니다. 업무를 진행하며 많은 조언을 들을 수 있었고 무엇보다 유저 입장에서 현재 스스로가 구현한 프로젝트에 대해서 생각하는 방법을 배웠습니다. 수직적인 업무 지시가 아닌 스스로 생각하고 풀어나갈 수 있도록 기회를 주시는 것이 제 생각과는 달라 매우 새로웠습니다. 그 외에도 매일 아침 스크럼이나 다 같이 모여 진행한 스프린트 회의 등 좋은 경험을 할 수 있어 좋았습니다.

## Dexter

안녕하세요. 너드팩토리의 프론트엔드 어시를 진행한 Dexter 유영근입니다. 기존 졸업프로젝트의 프론트엔드쪽 개선 작업 및 대시보드 작업을 진행하였습니다. 또한 중소/강소 기업을 대상으로 한 데이터 수집기 제작 및 AIVORY 개념그래프 프론트엔드 지원을 진행하였습니다. 다른 회사에서는 쉽게 볼 수 없는 문화인 데일리 스크럼을 진행하며 팀에서 문제를 해결하고 협의해 나가는 과정을 볼 수 있었던 좋은 경험이었습니다. 스스로 할일을 찾아가며 공부해 나가는 것이 성장에 큰 도움이 된다는 것을 깨달았습니다. 복학 후 지난 1년 6개월 동안의 시간보다 너드팩토리에서의 8주 동안의 인턴경험으로 얻은 것이 더 많다고 생각합니다.

## Salmon

안녕하세요. 너드팩토리에서 인턴으로 근무한 Salmon 김진수입니다. 본래 인턴 이전에 플랜아이와 진행하던 졸업프로젝트를 회사 내에서 좀 더 본격적으로 진행하였습니다. 또 너드팩토리에 들어오게 되면서 새로운 정책정보 크롤러프로젝트를 진행하였습니다. 실무를 해보지 않으면 배울 수 없는 부분이 명확히 있었습니다. 몰랐다면 언젠가 큰 실수가 되었을 수도 있었는데, 이번 인턴십을 통해 배워갈 수 있어서 다행이라고 생각합니다.